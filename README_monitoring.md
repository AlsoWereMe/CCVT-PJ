# Kubernetes Monitoring Scripts for Gomall

## æ¦‚è¿° (Overview)

è¿™äº›è„šæœ¬ç”¨äºè‡ªåŠ¨ç›‘æ§ Gomall å¾®æœåŠ¡åº”ç”¨çš„ Kubernetes éƒ¨ç½²çŠ¶æ€ï¼Œå¹¶æ‰§è¡ŒåŸºç¡€çš„ API æµ‹è¯•ã€‚

These scripts automatically monitor the Kubernetes deployment status of the Gomall microservices application and perform basic API tests.

## åŠŸèƒ½ç‰¹æ€§ (Features)

- âœ… **Pod çŠ¶æ€æ£€æŸ¥** - è‡ªåŠ¨æ£€æŸ¥æ‰€æœ‰ Pod æ˜¯å¦å¤„äº Running çŠ¶æ€
- ğŸ§ª **API æµ‹è¯•** - å¯¹æ‰€æœ‰å¾®æœåŠ¡æ‰§è¡ŒåŸºç¡€ API æµ‹è¯•
- ğŸ“Š **æœåŠ¡ä¿¡æ¯** - æ˜¾ç¤ºæœåŠ¡é…ç½®å’Œç«¯ç‚¹ä¿¡æ¯
- ğŸ”„ **è¿ç»­ç›‘æ§** - æ”¯æŒå®šæ—¶é‡å¤æ£€æŸ¥
- ğŸ¨ **å½©è‰²è¾“å‡º** - ç¾è§‚çš„è¡¨æ ¼å’ŒçŠ¶æ€æŒ‡ç¤º
- âš™ï¸ **å¯é…ç½®** - é€šè¿‡ YAML æ–‡ä»¶é…ç½®ç›‘æ§å‚æ•°

## å®‰è£…ä¾èµ– (Installation)

```bash
# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt

# æˆ–è€…
pip install kubernetes requests colorama tabulate pyyaml
```

## ä½¿ç”¨æ–¹æ³• (Usage)

### 1. å®Œæ•´å¥åº·æ£€æŸ¥ (Full Health Check)
```bash
python k8s_monitor.py
```

### 2. ä»…æ£€æŸ¥ Pod çŠ¶æ€ (Pod Status Only)
```bash
python k8s_monitor.py --pods-only
```

### 3. ä»…æ‰§è¡Œ API æµ‹è¯• (API Tests Only)
```bash
python k8s_monitor.py --api-only
```

### 4. æ˜¾ç¤ºæœåŠ¡ä¿¡æ¯ (Service Information)
```bash
python k8s_monitor.py --services
```

### 5. å¿«é€Ÿæ£€æŸ¥ (Quick Check)
```bash
python run_tests.py quick
```

### 6. è¿ç»­ç›‘æ§ (Continuous Monitoring)
```bash
# æ¯ 60 ç§’æ£€æŸ¥ä¸€æ¬¡
python run_tests.py continuous

# æ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡
python run_tests.py continuous 30
```

## è„šæœ¬è¯´æ˜ (Script Description)

### k8s_monitor.py
ä¸»è¦ç›‘æ§è„šæœ¬ï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š
- `check_pods_health()` - æ£€æŸ¥ Pod å¥åº·çŠ¶æ€
- `run_api_tests()` - æ‰§è¡Œ API æµ‹è¯•
- `get_service_info()` - è·å–æœåŠ¡ä¿¡æ¯
- `run_full_check()` - è¿è¡Œå®Œæ•´æ£€æŸ¥

### run_tests.py
æµ‹è¯•è¿è¡Œå™¨ï¼Œæ”¯æŒï¼š
- å•æ¬¡å¿«é€Ÿæ£€æŸ¥
- è¿ç»­ç›‘æ§æ¨¡å¼

### monitor_config.yaml
é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- æœåŠ¡ç«¯å£é…ç½®
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- ç›‘æ§é˜ˆå€¼è®¾ç½®

## è¾“å‡ºç¤ºä¾‹ (Sample Output)

### Pod çŠ¶æ€æ£€æŸ¥ (Pod Status Check)
```
ğŸ” Checking Pod Status...
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Status â”‚ Pod Name                        â”‚ Phase       â”‚ Ready   â”‚ Restarts    â”‚ Age   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ…     â”‚ cart-858fff8fc7-t44ht           â”‚ Running     â”‚ 1/1     â”‚ No restarts â”‚ 13h   â”‚
â”‚ âœ…     â”‚ frontend-9b55b5b68-dfwbx        â”‚ Running     â”‚ 1/1     â”‚ No restarts â”‚ 13h   â”‚
â”‚ âœ…     â”‚ gomall-mysql-0                  â”‚ Running     â”‚ 1/1     â”‚ No restarts â”‚ 13h   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ‰ All 11 pods are healthy and running!
```

### API æµ‹è¯•ç»“æœ (API Test Results)
```
ğŸ§ª Running API Tests...
================================================================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Status â”‚ Service   â”‚ Result â”‚ Endpoint        â”‚ Response Time â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ…     â”‚ frontend  â”‚ PASS   â”‚ :8080/          â”‚ 0.234s       â”‚
â”‚ âœ…     â”‚ cart      â”‚ PASS   â”‚ :8883/          â”‚ 0.156s       â”‚
â”‚ âœ…     â”‚ checkout  â”‚ PASS   â”‚ :8884/          â”‚ 0.178s       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ‰ All API tests passed!
```

## æ•…éšœæ’é™¤ (Troubleshooting)

### å¸¸è§é—®é¢˜ (Common Issues)

1. **Kubeconfig æ–‡ä»¶æœªæ‰¾åˆ°**
   ```bash
   # ç¡®ä¿ kind-kubeconfig.yaml æ–‡ä»¶å­˜åœ¨
   ls -la kind-kubeconfig.yaml
   ```

2. **ç«¯å£è½¬å‘å¤±è´¥**
   ```bash
   # æ£€æŸ¥ kubectl æ˜¯å¦æ­£å¸¸å·¥ä½œ
   kubectl get pods
   ```

3. **API æµ‹è¯•å¤±è´¥**
   ```bash
   # æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ
   kubectl get services
   kubectl logs deployment/service-name
   ```

## è‡ªå®šä¹‰é…ç½® (Customization)

ç¼–è¾‘ `monitor_config.yaml` æ–‡ä»¶æ¥è‡ªå®šä¹‰ï¼š
- ç›‘æ§çš„æœåŠ¡åˆ—è¡¨
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- è¶…æ—¶å’Œé‡è¯•è®¾ç½®
- å‘Šè­¦é˜ˆå€¼

## é›†æˆåˆ° CI/CD (CI/CD Integration)

```bash
# åœ¨ CI/CD ç®¡é“ä¸­ä½¿ç”¨
python run_tests.py quick
if [ $? -eq 0 ]; then
    echo "All tests passed"
else
    echo "Tests failed"
    exit 1
fi
```

## è®¸å¯è¯ (License)

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚ 